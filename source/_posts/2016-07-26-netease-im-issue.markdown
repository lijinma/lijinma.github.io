---
layout: post
title: "网易云信在阿里云服务器上无法发送大消息"
date: 2016-07-26 18:26:58 +0800
comments: true
categories: 
---

网易云信已经上线，用了一段时间发现了一个严重的问题。

1. 服务器端通过 Api 来发送消息的时候，只要消息超过一个大小，curl 就超时，HTTP 的 Response 没有任何的返回

2. 在本地的几个服务器上使用没有上面的问题。

3. 服务器上使用 tcpdump 发现在发送大的消息的时候，总会出现丢包重试的情况。


折腾了一段时间，确定是阿里云服务器的原因，就联系了阿里云的工程师进行联调，最后发现减小 MTU 的值可以解决上述问题。

一般 MTU 的默认值是 1500，当我们修改为 1360 的时候，就可以正常发送消息了。

分析待续。